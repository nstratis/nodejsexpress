/*global console, debug, aim, opera, alert, ActiveXObject, DOMTokenList */
/*jslint plusplus:true, nomen:true, bitwise:true, newcap:true, regexp:true, forin:true */
/**
 * @name AIM JavaScript Framework and Library
 * @author AV Digital Media Ltd.
 * @version 1.9.0
 * @copyright (c) Copyright 2013 - 2017 AV Digital Media Ltd. All Rights Reserved.
 * No unauthorized copying, distribution or modification to this code in whole
 * or in part is permitted without the express permission of
 * AV Digital Media Ltd (UK).
 */
 (function(){"use strict";
window.aim=window.aim||{};aim.loader=(function(){var o=false,d=false,p=true,t=false,s=false,k=[],r=[],q=false,u=0,c=0,m=0,e=null,l=null,g=false,v=null,y=null,a;function b(z){var A;for(A in z){if(z.hasOwnProperty(A)){if(A==="debug"){o=z[A];}if(A==="skipError"){d=z[A];}if(A==="skipCSSError"){p=z[A];}if(A==="deferBody"){t=z[A];}if(A==="jsAsync"){s=z[A];}if(A==="timer"){m=z[A];}}}}function w(){q=false;k=[];r=[];u=0;c=0;e=null;l=null;}function h(z){if(v!==null&&typeof v==="function"){setTimeout(function(){if(z===true){y();return;}v();},m);}}function f(A,z,D,B){if(q){console.warn("aim.loader: <link> file injections are not permitted mid load, wait until the current queue completes!");return aim.loader;}var C=k;if(B===true){C=r;}C.push({link:A,media:z,callback:((typeof z==="function")?z:D)});return aim.loader;}function x(z,C,A){if(q){console.warn("aim.loader: <script> file injections are not permitted mid load, wait until the current queue completes!");return aim.loader;}var B=k;if(A===true){B=r;}B.push({script:z,callback:C});return aim.loader;}function j(B){var A,z,C=k;if(B===true){C=r;}if(C[u]&&C[u]!==undefined){if(C[u].status===undefined){C[u].status="loading";z="script";if(C[u].link!==undefined){z="link";}A=document.createElement(z);if(A.onload!==undefined){A.onload=function(){if(o){console.log("%c AIM.Loader: onload: "+u+" : "+(C[u].link||C[u].script),"color: #090; display: block; font-family:arial;");}C[u].status="complete";setTimeout(function(){a(C,B,x);},m);};}else{A.onreadystatechange=function(){if(C[u].status==="loading"||x.readyState==="complete"){if(o){console.log("%c aim.loader: onreadystatechange: "+u+" : "+(C[u].link||C[u].script),"color: #090; display: block; font-family:arial;");}C[u].status="complete";setTimeout(function(){a(x);},m);}};}A.onerror=function(){if(o){console.log("%c aim.loader: Script Failed to load: "+(C[u].link||C[u].script),"color: #900; display: block; font-family:arial;");}if(d){a(C,B);}};if(C[u].link!==undefined){if(!C[u].link.match(/\.css/g)){C[u].link+=".css";}A.type="text/css";A.rel="stylesheet";A.href=C[u].link;A.media=C[u].media||"screen";if(B&&t){l.appendChild(A);}else{e.appendChild(A);}if(p){j();}}else{if(C[u].script!==undefined){A.type="text/javascript";if(s){A.async=true;}if(!C[u].script.match(/\.js/g)){C[u].script+=".js";}A.src=C[u].script;if(B&&t){l.appendChild(A);}else{e.appendChild(A);}}}}}}a=function(B,A,z){z.onload=x.onreadystatechange=null;if(B[u]&&B[u]!==undefined){if(B[u].callback!==undefined&&B[u].callback){B[u].callback();}u++;if(u<c){j(A);}else{if(document.readyState==="complete"||document.readyState==="loaded"){if(o){console.log("%c aim.loader: onreadystate:complete ","color: #090; display: block; font-family:arial;");}if(A===false){h();if(r.length===0){w();}else{if(g){if(o){console.log("%c aim.loader: docLoaded:complete ","color: #090; display: block; font-family:arial;");}u=0;c=r.length;j(true);}}}else{if(A===true){w();y();}}}else{document.onreadystatechange=function(){if(document.readyState==="complete"||document.readyState==="loaded"){if(o){console.log("%c aim.loader: onreadystatechange:complete ","color: #090; display: block; font-family:arial;");}if(A===false){h();if(r.length===0){w();}}else{if(A===true){w();y();}}}};}}}};function n(){window.addEventListener("load",function(){if(o){console.log("%c aim.loader: onload:complete ","color: #090; display: block; font-family:arial;");}l=document.body||document.getElementsByTagName("body")[0];g=true;if(document.readyState==="complete"||document.readyState==="loaded"){if(r.length>0&&u>=c){u=0;c=r.length;j(true);}}});}function i(A,z){if(q){console.warn("aim.loader: load() has already been initialized, wait until the current queue completes before trying to load additional file!");return;}c=k.length;e=document.getElementsByTagName("head")[0];v=(A!==undefined)?A:null;y=(z!==undefined)?z:null;if(g){l=document.body||document.getElementsByTagName("body")[0];}j(false);q=true;}n();return{options:b,script:x,link:f,load:i};}());}());
